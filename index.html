<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="utf-8" />
    <title>Chainsaw-Man Title</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <!-- Pyxel.js -->
    <script src="https://cdn.jsdelivr.net/gh/kitao/pyxel/wasm/pyxel.js"></script>
    <style>
      html, body {
        margin: 0;
        height: 100%;
        background: #000;
      }
      /* 画面中央にPyxelキャンバスをドット等倍拡大 */
      #wrap {
        position: fixed;
        inset: 0;
        display: grid;
        place-items: center;
        background: #000;
      }
      pyxel-run, canvas {
        image-rendering: pixelated;
      }
      /* “タップで開始”ガイド（任意） */
      #hint {
        position: fixed;
        inset: 0;
        display: grid;
        place-items: end center;
        padding-bottom: 24px;
        color: #bbb;
        font: 14px/1.2 -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
        user-select: none;
        pointer-events: none;
      }
    </style>
  </head>
  <body>
    <!-- BGM（自動再生しない）。最初のタップで再生 -->
    <audio id="bgm" src="./bgm.mp3" loop preload="auto"></audio>

    <div id="wrap">
      <!-- 同じディレクトリに main.py / title.png / bgm.mp3 がある想定 -->
      <pyxel-run root="." name="main.py"></pyxel-run>
    </div>

    <div id="hint">タップで開始</div>

    <script>
      // 初回のタップ/クリックでBGM再生（ブラウザのオートプレイ制限対策）
      function startBgmOnce() {
        const audio = document.getElementById('bgm');
        audio.play().catch(() => { /* サイレント失敗でOK */ });
        document.removeEventListener('touchstart', startBgmOnce, {passive:true});
        document.removeEventListener('mousedown', startBgmOnce);
        // ガイド非表示
        const hint = document.getElementById('hint');
        if (hint) hint.style.display = 'none';
      }
      document.addEventListener('touchstart', startBgmOnce, {passive:true, once:true});
      document.addEventListener('mousedown', startBgmOnce, {once:true});
    </script>
  </body>
</html>
