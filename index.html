<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="utf-8" />
    <title>Chainsaw-Man Title</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <script src="https://cdn.jsdelivr.net/gh/kitao/pyxel/wasm/pyxel.js"></script>
    <style>
      html, body { margin:0; height:100%; background:#000; }
      #wrap { position:fixed; inset:0; display:grid; place-items:center; background:#000; }
      pyxel-run, canvas { image-rendering: pixelated; }
      #hint {
        position: fixed; inset: 0; display: grid; place-items: end center;
        padding-bottom: 24px; color: #bbb;
        font: 14px/1.2 -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
        user-select: none; pointer-events: none;
      }
    </style>
  </head>
  <body>
    <audio id="bgm" src="./bgm.mp3" loop preload="auto"></audio>

    <div id="wrap">
      <pyxel-run root="." name="main.py"></pyxel-run>
    </div>

    <div id="hint">タップでBGM開始</div>

    <script>
      function startBgmOnce() {
        const audio = document.getElementById('bgm');
        audio.play().catch(()=>{});
        document.removeEventListener('touchstart', startBgmOnce, {passive:true});
        document.removeEventListener('mousedown', startBgmOnce);
        const hint = document.getElementById('hint');
        if (hint) hint.style.display = 'none';
      }
      document.addEventListener('touchstart', startBgmOnce, {passive:true, once:true});
      document.addEventListener('mousedown', startBgmOnce, {once:true});
    </script>
  </body>
</html>
